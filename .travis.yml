language: cpp

os:
  - linux

compiler:
  - gcc

before_install:
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - wget http://www.cmake.org/files/v3.2/cmake-3.2.3-Linux-x86_64.tar.gz
  - tar -xzf cmake-3.2.3-Linux-x86_64.tar.gz
  - sudo cp -fR cmake-3.2.3-Linux-x86_64/* /usr/
  - sudo add-apt-repository --yes ppa:boost-latest/ppa
  - sudo add-apt-repository --yes ppa:ubuntu-sdk-team/ppa
  - sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
  - sudo apt-get update -qq
  - sudo apt-get install -y gcc-4.9 g++-4.9
  - export CC="/usr/bin/gcc-4.9"
  - export CXX="/usr/bin/g++-4.9"
  - sudo apt-get install -y boost1.55
  - sudo apt-get install -y libicu-dev
  - sudo apt-get install -y libhunspell-dev
  - sudo apt-get install -y qt5-default qttools5-dev-tools
  - sudo apt-get install -y libelf-dev libdw-dev

install:
  - wget https://github.com/libgit2/libgit2/archive/v0.22.2.tar.gz -O libgit2-0.22.2.tar.gz
  - tar -xzf libgit2-0.22.2.tar.gz
  - cd libgit2-0.22.2
  - mkdir build
  - cd build
  - cmake .. -DBUILD_CLAR=OFF
  - make
  - sudo make install
  - cd ../../

before_script:
  - git submodule update --init --recursive
  - mkdir build
  - cd build
  - cmake -DCMAKE_BUILD_TYPE=Debug ..

script:
  - make
  - make test
